# Dotshef `/estimate` 단계형 견적 폼 아키텍처 명세서

Version 1.1\
대상 환경: Next.js (App Router 기준)\
채택 전략: 전략 1 -- Config 기반 Flow + 중앙 Calculator\
Flow 방향: 단방향 (되돌리기 없음)

------------------------------------------------------------------------

## 1. 프로젝트 개요

`/estimate` 페이지에 단계형 견적 폼(Multi-step Estimate Form)을
구현한다.

이 페이지는 사용자의 선택을 단계적으로 수집하고,\
마지막 단계에서 예상 견적 범위를 계산하여 보여준다.

------------------------------------------------------------------------

## 2. 핵심 요구사항

1.  모든 질문은 단방향 진행이다.\
2.  뒤로 가기 기능은 제공하지 않는다.\
3.  중간 단계 상태 복구는 지원하지 않는다.\
4.  마지막 결과 화면에서만 "다시 견적 내기" 버튼을 제공한다.\
5.  다시 견적을 누르면 `/estimate`로 이동하여 전체 상태를 초기화한다.\
6.  가격 계산 로직은 중앙에서만 수행한다.\
7.  JSON은 오직 가격 데이터 저장소 역할만 수행한다.

------------------------------------------------------------------------

## 3. 아키텍처 개요

### 책임 분리 구조

-   질문 및 분기 정의: flow.ts
-   가격 데이터: price-table.json
-   계산 로직: calculator.ts
-   다음 단계 계산: navigator.ts
-   UI 렌더링: EstimateWizard.tsx

------------------------------------------------------------------------

## 4. JSON 설계 원칙

JSON은 data/price-table.json을 참고한다.

### 포함 가능 항목

-   label
-   description
-   최소 금액
-   최대 금액

### 포함 불가 항목

-   조건 로직
-   분기 처리
-   계산식
-   수량 곱셈
-   정책 판단

------------------------------------------------------------------------

## 5. 중앙 Calculator 설계

모든 계산 및 정책은 calculator.ts에 존재해야 한다.

### 책임

1.  BASE 가격 적용
2.  UNIT × 수량 계산
3.  ADDON 합산
4.  FLOOR 적용
5.  최종 min/max 범위 산출

------------------------------------------------------------------------

## 6. Flow 정의

Flow는 다음만 정의한다:

-   Step ID
-   질문 텍스트
-   입력 타입
-   state에 저장될 필드
-   다음 Step 계산 함수

Flow 내부에 가격 계산 로직을 포함하지 않는다.

------------------------------------------------------------------------

## 7. 상태 모델

``` ts
type AnswerState = {
  productType?: "LANDING" | "CMS" | "SAAS"
  postTypeCount?: number
  hasAttachment?: boolean
  needsWysiwyg?: boolean
  dataKindCount?: number
  roleKindCount?: number
  addons?: string[]
  customRequirement?: string
}
```

------------------------------------------------------------------------

## 8. 결과 화면 요구사항

결과 화면은 다음을 포함해야 한다:

-   예상 견적 범위 표시
-   "실제 견적 요청하기" 버튼
-   "다시 견적 내기" 버튼

customRequirement가 존재하는 경우:

"예상 견적은 150만원 이상입니다." 형식으로 표시한다.

------------------------------------------------------------------------

## 9. 다시 견적 내기 동작

1.  상태 초기화
2.  `/estimate`로 이동
3.  새로운 세션 시작

예:

``` ts
router.replace("/estimate")
```

------------------------------------------------------------------------

## 10. Claude 작업 산출물

Claude는 다음 파일들을 생성해야 한다:

1.  flow.ts
2. calculator.ts
3. navigator.ts
4. EstimateWizard.tsx

제약 조건:

-   모든 계산은 calculator.ts에 존재한다.
-   JSON에는 조건 로직이 없다.
-   Flow에는 가격 로직이 없다.
-   되돌리기 기능은 구현하지 않는다.
-   "다시 견적 내기"는 전체 초기화 방식이다.

------------------------------------------------------------------------

문서 종료.
